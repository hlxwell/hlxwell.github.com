--- 
layout: post
title: Manage authorized_keys on all of your servers.
tags: 
- Life
status: publish
type: post
published: true
meta: 
  _edit_last: "1"
  _oembed_230e64107bc947b3d4abfe9d13f3f7c8: "{{unknown}}"
  _oembed_bb34ee8114e82d630450fb550f395529: "{{unknown}}"
  _oembed_72e5f567f9930ff94370465d715ebc8f: "{{unknown}}"
  _oembed_45c9bc22e4689758a9804999f0e62f4b: "{{unknown}}"
  _oembed_b3ed68aa247ee764a99db9ba7621001c: "{{unknown}}"
  _oembed_ffbe2fe15dde99844e8cbd024e508d7e: "{{unknown}}"
  _oembed_15de91079d924364db607135d986fe42: "{{unknown}}"
  _oembed_ea3b88801187b56fdae71eeb15d57e00: "{{unknown}}"
  _oembed_c665a8a7d71cc15fb3bf324f953d1121: "{{unknown}}"
  _oembed_f69214ce31a8bdbdbe280fda43f7fd6f: "{{unknown}}"
  _oembed_9e2512e62240444051e3a828e0d07a66: "{{unknown}}"
  _oembed_ca4a168d7413da4f5f4133ac249f1bbd: "{{unknown}}"
---
<h1>SSH Key sync tool</h1>
This tool is used to mass deploy ssh-keys to all your servers according to the config.

You can download at `https://github.com/hlxwell/ssh-key-sync-man`
<h1>Usage</h1>
<ul>
	<li><strong><span style="font-family: monospace; font-size: 14px; line-height: 22px;">gem install ssh-key-sync-man</span></strong></li>
	<li>Put all your team members' keys into one <code>available_public_keys</code> directory with the structure looks like:</li>
</ul>
<ol></ol>
<p style="padding-left: 60px;">available_public_keys/groupA/michael</p>
<p style="padding-left: 60px;">available_public_keys/------/jason</p>
<p style="padding-left: 60px;">available_public_keys/------/john</p>
<p style="padding-left: 60px;">available_public_keys/groupB/rose</p>
<p style="padding-left: 60px;">available_public_keys/------/ryan</p>

<ul>
	<li>Add a <code>server_list.yml</code>, format like:</li>
</ul>
<ol></ol>
servers: groupA: - host: xxx.com user: app groupB: - host: aaa.com user: app alias: app_server - host: aaa.com user: db alias: db_master

(You can puts <code>available_public_keys</code> and <code>server_list.yml</code> at github, them people can add files by themselves)
<ul>
	<li><strong>ssh-key-sync-man -g groupA</strong></li>
</ul>
<ol></ol>
This will deploy public keys in <code>available_public_keys/groupA</code> to groupA servers
<h1>"alias" list -- linux shotcut command list auto generator</h1>
<strong><code>ssh-key-sync-man -a michael</code></strong> to generate alias for michael.

Generate alias file for everyone, for example:
<p style="padding-left: 30px;">michael alias myasics_app1="ssh app@host"</p>
<p style="padding-left: 30px;">alias myasics_app2="ssh app@host"</p>
<p style="padding-left: 30px;">alias myasics_db="ssh app@host"</p>
<p style="padding-left: 30px;">alias myasics_staging="ssh app@host"</p>
You can copy and paste into your .bashrc or .bash_profile

&nbsp;
